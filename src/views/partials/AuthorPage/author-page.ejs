<div class="max-w-[90rem] mx-auto px-4 sm:px-6 lg:px-8 py-6">
    <div class="flex flex-col space-y-6 lg:space-y-0 lg:space-x-6">
        <div class="bg-[#F5F5F5] p-2 rounded-xl flex flex-col space-y-4">
            <img src="/images/bg-author.png" alt="" class="w-full">
            <div class="flex items-center space-x-4 relative">
                <img src="https://ui-avatars.com/api/?name=<%= author.name %>&background=random&color=fff&size=40&font-size=0.5"
                    alt="" class="w-16 h-16 rounded-xl">
                <div class="flex flex-col justify-center space-y-2">
                    <p class="text-xl font-semibold">
                        <%= author.name %>
                    </p>
                    <div class="flex flex-row items-center">
                        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 512 512" class="w-4 h-4 text-gray-400">
                            <path
                                d="M168 80c-13.3 0-24 10.7-24 24l0 304c0 8.4-1.4 16.5-4.1 24L440 432c13.3 0 24-10.7 24-24l0-304c0-13.3-10.7-24-24-24L168 80zM72 480c-39.8 0-72-32.2-72-72L0 112C0 98.7 10.7 88 24 88s24 10.7 24 24l0 296c0 13.3 10.7 24 24 24s24-10.7 24-24l0-304c0-39.8 32.2-72 72-72l272 0c39.8 0 72 32.2 72 72l0 304c0 39.8-32.2 72-72 72L72 480zM176 136c0-13.3 10.7-24 24-24l96 0c13.3 0 24 10.7 24 24l0 80c0 13.3-10.7 24-24 24l-96 0c-13.3 0-24-10.7-24-24l0-80zm200-24l32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l32 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-32 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zM200 272l208 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-208 0c-13.3 0-24-10.7-24-24s10.7-24 24-24zm0 80l208 0c13.3 0 24 10.7 24 24s-10.7 24-24 24l-208 0c-13.3 0-24-10.7-24-24s10.7-24 24-24z" />
                        </svg>
                        <p class="ml-2 text-xs text-gray-400">
                            Bài viết: <%= articles.length %>
                        </p>
                    </div>
                </div>
                <div class="absolute left-1/2 transform -translate-x-1/2 bottom-0 translate-y-1/2">
                    <div
                        class="bg-white flex justify-center items-center space-x-6 py-2 rounded-xl font-medium text-center">
                        <span id="articlesTab" class="px-6 cursor-pointer text-blue-600"
                            onclick="switchTab('articles')">
                            Bài viết
                        </span>
                        <span id="profileTab" class="px-6 cursor-pointer border-b-2 border-transparent"
                            onclick="switchTab('profile')">
                            Cá nhân
                        </span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Content sections -->
        <div id="articlesContent" class="">
            <!-- Articles grid here -->
            <div class="border-l-4 border-red-600 text-lg font-semibold rounded-s-sm mt-6">
                <p class="ml-2">Bài viết</p>
            </div>
            <div class="grid grid-cols-4 gap-4 mt-8">
                <% articles.forEach(article=> { %>
                    <a href="/article/<%= article._id %>" class="block hover:shadow-lg transition-all duration-300">
                        <div class="bg-white rounded-lg shadow overflow-hidden p-2">
                            <!-- Image -->
                            <div class="relative w-full h-48">
                                <img src="<%= article.image %>" alt="<%= article.name %>"
                                    class="w-full h-full object-cover rounded-xl">
                                <% if (article.isPremium) { %>
                                    <div class="absolute top-2 left-2">
                                        <svg class="w-6 h-6 text-yellow-400" aria-hidden="true"
                                            xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 24 24">
                                            <path d="M11 9a1 1 0 1 1 2 0 1 1 0 0 1-2 0Z" />
                                            <path fill-rule="evenodd"
                                                d="M9.896 3.051a2.681 2.681 0 0 1 4.208 0c.147.186.38.282.615.255a2.681 2.681 0 0 1 2.976 2.975.681.681 0 0 0 .254.615 2.681 2.681 0 0 1 0 4.208.682.682 0 0 0-.254.615 2.681 2.681 0 0 1-2.976 2.976.681.681 0 0 0-.615.254 2.682 2.682 0 0 1-4.208 0 .681.681 0 0 0-.614-.255 2.681 2.681 0 0 1-2.976-2.975.681.681 0 0 0-.255-.615 2.681 2.681 0 0 1 0-4.208.681.681 0 0 0 .255-.615 2.681 2.681 0 0 1 2.976-2.975.681.681 0 0 0 .614-.255Z" />
                                        </svg>
                                    </div>
                                    <% } %>
                            </div>
                            <!-- Content -->
                            <div class="flex flex-col space-y-4 mt-2 ml-2">
                                <h3 class="font-semibold text-lg line-clamp-1">
                                    <%= article.name %>
                                </h3>
                                <div class="flex flex-row space-x-2 mb-3">
                                    <!-- Parent Category -->
                                    <div class="p-1 flex text-xs justify-center border border-black rounded-xl w-[32%]">
                                        <% if (article.category && article.category.length> 0) { %>
                                            <% const parentCategory=categories.find(cat=> cat._id ===
                                                article.category[0]); %>
                                                <%= parentCategory ? parentCategory.name : 'Unknown Category' %>
                                                    <% } else { %>
                                                        No category
                                                        <% } %>
                                    </div>

                                    <!-- Child Categories -->
                                    <% if (article.category && article.category.length> 1) { %>
                                        <% article.category.slice(1).forEach(childId=> {
                                            const childCategory = categories.find(cat => cat._id === childId);
                                            %>
                                            <span class="text-xs text-cyan-500 flex justify-center items-center">
                                                #<%= childCategory ? childCategory.name : 'Unknown Category' %>
                                            </span>
                                            <% }); %>
                                                <% } %>
                                </div>
                                <p class="text-sm text-gray-500 line-clamp-3">
                                    <%= article.abstract %>
                                </p>
                                <p class="text-sm text-gray-500">
                                    <%= author.name %> | <%= article.publishedAt ?
                                            article.publishedAt.split(',')[1]?.trim() || article.publishedAt : 'No date'
                                            %>
                                </p>
                            </div>
                        </div>
                    </a>
                    <% }); %>
            </div>

            <!-- Pagination -->
            <% if (pagination.totalPages> 1) { %>
                <div class="flex justify-center mt-8 gap-2">
                    <% for(let i=1; i <=pagination.totalPages; i++) { %>
                        <button data-page="<%= i %>"
                            class="pagination-btn px-4 py-2 rounded <%= i === pagination.currentPage ? 'bg-blue-600 text-white' : 'bg-gray-200 hover:bg-gray-300' %>">
                            <%= i %>
                        </button>
                        <% } %>
                </div>
                <% } %>
        </div>

        <div id="profileContent" class="hidden grid grid-cols-2 gap-12 mx-4">
            <div class="space-y-5 mt-6">
                <div class="flex flex-col space-y-2">
                    <div class="text-base font-medium text-black">Họ và tên</div>
                    <div class="text-lg text-gray-900 bg-gray-100 px-4 py-3 rounded-lg"><%- author.fullName %></div>
                </div>
                <div class="flex flex-col space-y-2">
                    <div class="text-base font-medium text-black">Ngày sinh</div>
                    <div class="text-lg text-gray-900 bg-gray-100 px-4 py-3 rounded-lg"><%- formatDate(author.dob) %>
                    </div>
                </div>
                <div class="flex flex-col space-y-2">
                    <div class="text-base font-medium text-black">Email liên hệ</div>
                    <div class="text-lg text-gray-900 bg-gray-100 px-4 py-3 rounded-lg"><%- author.email %></div>
                </div>
            </div>
            <div class="space-y-5 mt-6">
                <div class="flex flex-col space-y-2">
                    <div class="text-base font-medium text-black">Giới tính</div>
                    <div class="text-lg text-gray-900 bg-gray-100 px-4 py-3 rounded-lg">
                        <%= author.gender==='male' ? 'Nam' : author.gender==='female' ? 'Nữ' : 'None' %>
                    </div>
                </div>
                <div class="flex flex-col space-y-2">
                    <div class="text-base font-medium text-black">Quốc tịch</div>
                    <div class="text-lg text-gray-900 bg-gray-100 px-4 py-3 rounded-lg">
                        <%= author.country==='VN' ? 'Việt Nam' : author.country==='US' ? 'Hoa Kỳ' :
                            author.country==='JP' ? 'Nhật Bản' : author.country==='KR' ? 'Hàn Quốc' :
                            author.country==='CN' ? 'Trung Quốc' : 'Khác' %>
                    </div>
                </div>
                <div class="flex flex-col space-y-2">
                    <div class="text-base font-medium text-black">Số điện thoại</div>
                    <div class="text-lg text-gray-900 bg-gray-100 px-4 py-3 rounded-lg"><%- author.phone %></div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    function switchTab(tab) {
        // Update tab styles
        document.getElementById('articlesTab').classList.toggle('border-blue-600', tab === 'articles');
        document.getElementById('articlesTab').classList.toggle('text-blue-600', tab === 'articles');
        document.getElementById('profileTab').classList.toggle('border-blue-600', tab === 'profile');
        document.getElementById('profileTab').classList.toggle('text-blue-600', tab === 'profile');

        // Toggle content visibility
        document.getElementById('articlesContent').classList.toggle('hidden', tab !== 'articles');
        document.getElementById('profileContent').classList.toggle('hidden', tab !== 'profile');

        // Update URL with tab type
        const currentUrl = new URL(window.location.href);
        const page = currentUrl.searchParams.get('page') || 1;

        if (tab === 'articles') {
            window.history.pushState({}, '', `?articles&page=${page}`);
        } else {
            window.history.pushState({}, '', `?profile`);
        }
    }

    document.addEventListener('DOMContentLoaded', function () {
        const buttons = document.querySelectorAll('.pagination-btn');

        buttons.forEach(button => {
            button.addEventListener('click', function () {
                const page = this.dataset.page;
                const currentTab = window.location.search.includes('articles') ? 'articles' : 'profile';

                if (currentTab === 'articles') {
                    window.location.href = `?articles&page=${page}`;
                } else {
                    window.location.href = `?profile`;
                }
            });
        });
    });
</script>