<!-- User Table -->
<div class="bg-white shadow rounded-md overflow-hidden">
    <table class="min-w-full text-base text-gray-700">
        <thead class="bg-gray-200">
            <tr>
                <th class="px-6 py-3 text-left font-semibold">Tên</th>
                <th class="px-6 py-3 text-left font-semibold">Tài khoản</th>
                <th class="px-6 py-3 text-left font-semibold">Vai trò</th>
                <th class="px-6 py-3 text-left font-semibold">Chọn chuyên mục</th>
                <th class="px-6 py-3 text-left font-semibold">Hành động</th>
            </tr>
        </thead>
        <tbody>
            <% const roleMap={ 'admin' : 'Quản trị viên' , 'subscriber' : 'Độc giả' , 'editor' : 'Biên tập viên'
                , 'author' : 'Phóng viên' }; %>
                <% users.forEach(userData=> { %>
                    <tr class="border-t">
                        <td class="px-6 py-3"><%- userData.name %></td>
                        <td class="px-6 py-3"><%- userData.email %></td>
                        <td class="px-6 py-3">
                            <%= roleMap[userData.role] || userData.role %>
                        </td>

                        <!-- Dropdown Chuyên mục -->
                        <td class="px-6 py-3">
                            <select class="form-select border border-gray-300 text-gray-700 rounded-md py-1 px-2">
                                <% categories.forEach(category=> { %>
                                    <option value="<%= category._id %>" <%=userData.category &&
                                        userData.category._id===category._id ? 'selected' : '' %> >
                                        <%= category.name %>
                                    </option>
                                    <% }); %>
                            </select>
                        </td>

                        <td class="px-6 py-3">
                            <button class="bg-blue-500 text-white px-4 py-1 rounded-md hover:bg-blue-700 transition">
                                Gia hạn
                            </button>
                        </td>
                    </tr>
                    <% }); %>
        </tbody>
    </table>
</div>
<!-- Pagination -->
<% if (pagination.totalPages> 1) { %>
    <div class="flex justify-center mt-8 gap-2">
        <% for(let i=1; i <=pagination.totalPages; i++) { %>
            <button data-page="<%= i %>"
                class="pagination-btn px-4 py-2 rounded <%= i === pagination.currentPage ? 'bg-blue-600 text-white' : 'bg-gray-200 hover:bg-gray-300' %>">
                <%= i %>
            </button>
            <% } %>
    </div>
    <% } %>
        </div>


        <script>
            document.addEventListener('DOMContentLoaded', function () {
                const buttons = document.querySelectorAll('.pagination-btn');

                buttons.forEach(button => {
                    button.addEventListener('click', function () {
                        const page = this.dataset.page;
                        // Use window.location to reload page with new page parameter
                        window.location.href = `/manage-user/?page=${page}`;
                    });
                });
            });
        </script>